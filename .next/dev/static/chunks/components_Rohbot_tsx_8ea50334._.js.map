{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/rohanrajebhosale/Development/final_Portfolio/components/Rohbot.tsx"],"sourcesContent":["'use client';\nimport { useState, useEffect, useRef } from 'react';\nimport gsap from 'gsap';\nimport { useGSAP } from '@gsap/react';\nimport { Mic, Send, X, Square, MessageSquare } from 'lucide-react';\n\nexport default function Rohbot() {\n    const [isOpen, setIsOpen] = useState(false);\n    const [input, setInput] = useState('');\n    const [messages, setMessages] = useState([]);\n    const [isTyping, setIsTyping] = useState(false);\n    const [isBotSpeaking, setIsBotSpeaking] = useState(false);\n    const [isListening, setIsListening] = useState(false);\n\n    const chatWindowRef = useRef(null);\n    const scrollRef = useRef(null);\n    const audioRef = useRef<HTMLAudioElement | null>(null);\n    const recognitionRef = useRef<any>(null);\n\n    // 1. Setup Voice Recognition (Web Speech API)\n    useEffect(() => {\n        const SpeechRecognition = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\n        if (SpeechRecognition) {\n            const recognition = new SpeechRecognition();\n            recognition.continuous = false;\n            recognition.lang = 'en-US';\n\n            recognition.onstart = () => { setIsListening(true); stopBotSpeaking(); };\n            recognition.onend = () => setIsListening(false);\n            recognition.onresult = (event: any) => {\n                const transcript = event.results[0][0].transcript;\n                setInput(transcript);\n                handleSendMessage(transcript);\n            };\n            recognitionRef.current = recognition;\n        }\n    }, []);\n\n    // 2. GSAP Animations for Window\n    useGSAP(() => {\n        if (isOpen) {\n            gsap.to(chatWindowRef.current, { autoAlpha: 1, scale: 1, duration: 0.4, ease: \"power2.out\" });\n            if (messages.length === 0) {\n                const welcome = \"Hello. I am ROHbot, an AI twin of Rohan. Ask me anything about his skills or projects.\";\n                addBotMessage(welcome);\n            }\n        } else {\n            gsap.to(chatWindowRef.current, { autoAlpha: 0, scale: 0.9, duration: 0.3, ease: \"power2.in\" });\n        }\n    }, [isOpen]);\n\n    useEffect(() => {\n        if (scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }, [messages]);\n\n    // 3. RAG Streaming Logic\n    const handleSendMessage = async (textOverride?: string) => {\n        const text = textOverride || input;\n        if (!text.trim()) return;\n\n        const userMsg = { role: 'user', content: text };\n        setMessages(prev => [...prev, userMsg]);\n        setInput('');\n        setIsTyping(true);\n\n        try {\n            const response = await fetch('https://rohbot.vercel.app/api/chat', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ userInput: text, history: messages.map(m => ({ role: m.role === 'user' ? 'user' : 'model', parts: [{ text: m.content }] })) })\n            });\n\n            if (!response.body) return;\n            const reader = response.body.getReader();\n            const decoder = new TextDecoder();\n            let fullReply = \"\";\n\n            // Create placeholder for bot message\n            setMessages(prev => [...prev, { role: 'bot', content: \"\" }]);\n\n            while (true) {\n                const { done, value } = await reader.read();\n                if (done) break;\n                const chunk = decoder.decode(value, { stream: true });\n                fullReply += chunk;\n\n                // Update the last message in state (streaming effect)\n                setMessages(prev => {\n                    const newMsgs = [...prev];\n                    newMsgs[newMsgs.length - 1].content = fullReply;\n                    return newMsgs;\n                });\n            }\n            speakText(fullReply);\n        } catch (e) {\n            setMessages(prev => [...prev, { role: 'bot', content: \"Connection error. Try again!\" }]);\n        } finally {\n            setIsTyping(false);\n        }\n    };\n\n    // 4. TTS Logic\n    const speakText = async (text: string) => {\n        stopBotSpeaking();\n        setIsBotSpeaking(true);\n        try {\n            const res = await fetch('https://rohbot.vercel.app/api/tts', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ text })\n            });\n            if (!res.ok) throw new Error();\n            const blob = await res.blob();\n            const url = URL.createObjectURL(blob);\n            audioRef.current = new Audio(url);\n            audioRef.current.play();\n            audioRef.current.onended = () => { setIsBotSpeaking(false); URL.revokeObjectURL(url); };\n        } catch {\n            const utterance = new SpeechSynthesisUtterance(text);\n            window.speechSynthesis.speak(utterance);\n            setIsBotSpeaking(false);\n        }\n    };\n\n    const stopBotSpeaking = () => {\n        if (audioRef.current) { audioRef.current.pause(); audioRef.current = null; }\n        window.speechSynthesis.cancel();\n        setIsBotSpeaking(false);\n    };\n\n    const addBotMessage = (text: string) => {\n        setMessages(prev => [...prev, { role: 'bot', content: text }]);\n        speakText(text);\n    };\n\n    return (\n        <div className=\"fixed bottom-6 right-6 z-[9999] font-sans\">\n            {/* FAB Avatar */}\n            <button\n                onClick={() => setIsOpen(!isOpen)}\n                className=\"w-16 h-16 rounded-full border-2 border-blue-600 bg-black flex items-center justify-center shadow-2xl hover:scale-105 transition-transform overflow-hidden\"\n            >\n                <img src=\"/avatar-rohan.png\" alt=\"ROHbot\" className=\"w-full h-full object-cover\" />\n            </button>\n\n            {/* Chat Window */}\n            <div\n                ref={chatWindowRef}\n                className=\"absolute bottom-20 right-0 w-[380px] h-[550px] bg-[#0d1117] border border-gray-800 rounded-2xl shadow-2xl flex flex-col overflow-hidden invisible\"\n                style={{ transform: 'scale(0.9)', opacity: 0 }}\n            >\n                <div className=\"p-4 bg-[#161b22] border-b border-gray-800 flex justify-between items-center\">\n                    <span className=\"font-bold flex items-center gap-2\">ü§ñ ROHbot <span className=\"text-[10px] text-green-500\">‚óè LIVE</span></span>\n                    <button onClick={() => setIsOpen(false)} className=\"text-gray-500 hover:text-white\"><X size={20} /></button>\n                </div>\n\n                <div ref={scrollRef} className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n                    {messages.map((m, i) => (\n                        <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}>\n                            <div className={`max-w-[85%] p-3 rounded-2xl text-sm ${m.role === 'user' ? 'bg-blue-600 text-white rounded-tr-none' : 'bg-[#21262d] text-gray-200 rounded-tl-none'}`}>\n                                {m.content}\n                            </div>\n                        </div>\n                    ))}\n                    {isTyping && <div className=\"text-xs text-gray-500 animate-pulse\">Streaming response...</div>}\n                </div>\n\n                <div className=\"p-4 bg-[#0d1117] border-t border-gray-800 space-y-3\">\n                    <div className=\"flex gap-2\">\n                        <input\n                            value={input}\n                            onChange={(e) => setInput(e.target.value)}\n                            onKeyDown={(e) => e.key === 'Enter' && handleSendMessage()}\n                            placeholder=\"Ask me anything...\"\n                            className=\"flex-1 bg-[#010409] border border-gray-800 rounded-xl px-4 py-2 text-sm text-white focus:outline-none focus:border-blue-500\"\n                        />\n                        <button\n                            onClick={() => isBotSpeaking ? stopBotSpeaking() : handleSendMessage()}\n                            className={`p-2 rounded-xl transition-colors ${isBotSpeaking ? 'bg-red-500' : 'bg-blue-600'}`}\n                        >\n                            {isBotSpeaking ? <Square size={18} fill=\"white\" /> : <Send size={18} />}\n                        </button>\n                        <button\n                            onClick={() => recognitionRef.current?.start()}\n                            className={`p-2 rounded-xl border border-gray-700 transition-all ${isListening ? 'bg-red-500 animate-pulse' : 'bg-gray-800'}`}\n                        >\n                            <Mic size={18} />\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}"],"names":[],"mappings":"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"}}]
}